import{createClient as E}from"https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";const g="https://lqznaoovmqsfipptlktu.supabase.co",C="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxxem5hb292bXFzZmlwcHRsa3R1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODkwMTQzMzksImV4cCI6MjAwNDU5MDMzOX0.CXn7Be_747VSWkg6JQ0LLm6AmQeCmSqRxrSRNatfoL0",b=document.getElementById("form"),y=document.getElementById("contenedor"),i=E(g,C);let o=null;l();async function l(){try{const e=i.from("posts").select("*").order("created_at",{ascending:!0});o&&e.gt("created_at",o);const{data:c,error:s}=await e;s?console.error("Error fetching posts:",s):c.forEach(t=>{const n=new Date(t.created_at),u=n.toLocaleString("es",{day:"numeric"}),p=n.toLocaleString("es",{month:"long"}),I=n.toLocaleString("es",{year:"numeric"}),f=n.toLocaleString("es",{hour:"numeric",minute:"numeric",hour12:!0}),h=`el ${u} de ${p} de ${I}, a las ${f}`,a=document.createElement("div");a.classList.add("msg","drag-it");const r=document.createElement("span");r.classList.add("name"),r.textContent=t.nombre+", ";const m=document.createElement("span");m.classList.add("date"),m.textContent=h;const d=document.createElement("div");d.classList.add("text"),d.textContent=t.mensaje,a.appendChild(r),a.appendChild(m),a.appendChild(d),y.appendChild(a),(!o||t.created_at>o)&&(o=t.created_at)})}catch(e){console.error("Error:",e)}}b.addEventListener("submit",async e=>{e.preventDefault();const c=nombreInput.value,s=mensajeInput.value,{data:t,error:n}=await i.from("posts").insert([{nombre:c,mensaje:s}]);n||(nombreInput.value="",mensajeInput.value="",await l())});
